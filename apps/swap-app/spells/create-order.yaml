# Create Order Spell
# Creates a new swap order in the Liquid Nation orderbook
# 
# Variables:
#   - app_id: Swap app identity
#   - app_vk: Swap app verification key
#   - offer_token_id: Token being offered
#   - offer_token_vk: Offer token verification key
#   - in_utxo_0: Funding UTXO (used for order identity)
#   - addr_escrow: Escrow address for the order
#   - maker_pubkey: Maker's public key (hex)
#   - offer_amount: Amount of tokens to offer
#   - want_token_id: Token wanted in exchange
#   - want_amount: Amount of tokens wanted
#   - dest_chain: Destination chain (0=Bitcoin, 1=Cardano)
#   - dest_address: Destination address on target chain
#   - expiry_height: Block height when order expires
#   - allow_partial: Whether partial fills are allowed (true/false)

version: 8

apps:
  $ORDER: n/${app_id}/${app_vk}
  $OFFER: t/${offer_token_id}/${offer_token_vk}

public_inputs:
  $ORDER: "create"

private_inputs:
  $ORDER: "${in_utxo_0}"

ins:
  - utxo_id: ${in_utxo_0}
    charms:
      $OFFER: ${offer_amount}

outs:
  # Order NFT with locked tokens in escrow
  - address: ${addr_escrow}
    charms:
      $ORDER:
        maker_pubkey: ${maker_pubkey}
        offer_app_id: ${offer_token_id}
        offer_amount: ${offer_amount}
        want_app_id: ${want_token_id}
        want_amount: ${want_amount}
        dest_chain: ${dest_chain}
        dest_address: ${dest_address}
        expiry_height: ${expiry_height}
        allow_partial: ${allow_partial}
        status: 0
        filled_amount: 0
      $OFFER: ${offer_amount}

